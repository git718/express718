"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.blobToCanvas = exports.blobToBase64 = void 0;
const crossPlatform_1 = require("./crossPlatform");
function blobToBase64(blob, config = { appendDataUrl: false }) {
    if (crossPlatform_1.isNode) {
        return blobToBase64_Node(blob);
    }
    return new Promise((resolve) => {
        const reader = new FileReader();
        reader.readAsDataURL(blob);
        reader.onloadend = () => {
            const dataUrl = reader.result;
            resolve(config?.appendDataUrl ? dataUrl : dataUrl.split(',')[1]);
        };
    });
}
exports.blobToBase64 = blobToBase64;
async function blobToBase64_Node(blob) {
    const arrayBuffer = await blob.arrayBuffer();
    const uint8 = new Uint8Array(arrayBuffer);
    return Buffer.from(uint8).toString('base64'); //TODO: this might be problematic. Explore a different solution.
}
async function blobToCanvas(blob) {
    var canvas = document.createElement('canvas');
    var ctx = canvas.getContext('2d');
    var img = new Image();
    img.src = URL.createObjectURL(blob);
    await new Promise((res) => img.onload = res);
    canvas.height = img.height;
    canvas.width = img.width;
    ctx.drawImage(img, 0, 0, img.width, img.height);
    return canvas;
}
exports.blobToCanvas = blobToCanvas;
//# sourceMappingURL=blob.js.map